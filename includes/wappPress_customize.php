<?phpclass wappPress_customize extends wappPress {    public function __construct() {        // Run security checks *after* WordPress is fully loaded        add_action( 'init', array( $this, 'maybe_verify_nonce' ) );        // Redirect if theme param is missing        add_action( 'admin_init', array( $this, 'maybe_return_url' ) );        // Modify back button URL        add_filter( 'clean_url', array( $this, 'back_button_url' ) );    }    /**	 * Verify nonce for WappPress requests	 */	public function maybe_verify_nonce() {		if ( ! isset( $_GET['wapppress_nonce'] ) ) {			return;		}		check_admin_referer( 'wapppress_action', 'wapppress_nonce' );		if ( ! isset( $_GET['wapppress'] ) ) {			return;		}		$flag = absint( wp_unslash( $_GET['wapppress'] ) );		if ( 1 !== $flag ) {			return;		}		// ✅ Safe to continue	}    /** * Redirect back to theme page if 'theme' param is missing */	public function maybe_return_url() {		// 1️⃣ Require nonce		if ( ! isset( $_GET['wapppress_nonce'] ) ) {			return;		}		check_admin_referer( 'wapppress_action', 'wapppress_nonce' );		// 2️⃣ Now it is safe to read $_GET		if ( ! isset( $_GET['wapppress'] ) || isset( $_GET['theme'] ) ) {			return;		}		$flag = absint( wp_unslash( $_GET['wapppress'] ) );		if ( 1 !== $flag ) {			return;		}		$url = add_query_arg(			'page',			'wapppresstheme',			admin_url( 'admin.php' )		);		wp_safe_redirect( $url );		exit;	}    /**     * Change the back button URL     */    public function back_button_url( $changeUrl ) {        if ( $changeUrl === admin_url( 'themes.php' ) ) {            return esc_url(                add_query_arg(                    'page',                    'wapppresstheme',                    admin_url( 'admin.php' )                )            );        }        return $changeUrl;    }}